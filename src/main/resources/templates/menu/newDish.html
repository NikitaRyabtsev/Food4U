<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <link rel="icon" th:href="@{/images/favicon.ico}">
    <link rel="stylesheet" th:href="@{/css/select.css}">
    <link rel="stylesheet" th:href="@{/nav/stylenav.css}">
    <link rel="stylesheet" th:href="@{/nav/leftnav.css}">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <meta charset="UTF-8">
    <style>
        * {
            box-sizing: border-box;
            font-family: sans-serif;
        }

        .add {
            border: 2px solid #000;
        }

        input {
            margin: 10px 0px;
        }

        .form-new-dish {
            border: 2px solid #000;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
    </style>
    <title>Добавление блюда с ингредиентами</title>
</head>
<body role="main" style="text-align: center">
<header class="header_header">
    <div th:insert="/viewhtml/header :: header"></div>
</header>
<nav>
    <div th:insert="/viewhtml/nav :: nav"></div>
</nav>
<h3>Добавить новое блюдо</h3>
<form class="form-new-dish" th:action="@{/menu/newDish}" th:method="POST" th:object="${dish_ingredient}" id="newDish">
    <label for="name">Введите название</label>
    <br/>
    <input type="text" th:field="*{dish.name}" id="name" class="add__btn" name="name" required>
    <br/>
    <label>Введите тип</label>
    <br/>
    <select th:field="*{dish.type}" name="type" id="type" class="select">
        <option value="0">Выберите тип</option>
        <option th:each="dish : ${T(by.htp.netcracker.foodfactory.Helper.Type).values()}"
                th:value="${dish}" th:text="${dish.displayValue}">
        </option>
    </select>
    <h4 class="combo-label">Выберите ингредиенты</h4>
    <button class="addIngredient" type="button">Добавить ингредиент</button>

<!--    <div th:each="dish_ingredient:${dish_ingredients}">-->
<!--            <input type="text" th:field="*{dish_ingredient.id}" th:value="">-->
<!--    </div>-->

<!--    <input type="number"  th:field="*{dish_ingredients}" th:text="${dish_ingredient.ingredient.name}">-->

    <select th:field="*{ingredient}" multiple>
        <option th:each="ingredient:${ingredients}" th:value="${ingredient.id}"
                th:text="${ingredient.name}"></option>
    </select>
<!-- <input class="create-ing__weigth" type="text" name="create-ing__weigth" required>-->

    <label for="price">Введите цену</label>

    <input type="number" th:field="*{dish.price}" id="price" class="add__btn" required>

    <label for="src">Введите путь к картинке</label>

    <input type="text" th:field="*{dish.src}" id="src" name="src" class="add__btn">

    <input type="submit" value="Создать" class="btn btn-secondary" id="btn">
</form>
<!--        <a href="/menu/newIngredientInDish">-->
<!--            <button type="button">Добавить новый ингредиент</button>>-->
<!--        </a>-->
<footer>
    <div th:insert="/viewhtml/footer :: footer"></div>
</footer>

<!--<script>-->
<!--    let form = document.querySelector('.form-new-dish');-->
<!--    form.onsubmit = (event) => {-->
<!--        event.preventDefault();-->

<!--        let formData = new FormData(form);-->

<!--        // delete useless data from create-ing-->
<!--        formData.delete('ingredients');-->
<!--        formData.delete('create-ing__weigth');-->

<!--        for (let [name, value] of formData) {-->
<!--            console.log(name + ':' + value)-->
<!--        }-->

<!--        fetch('/menu/newDish', {-->
<!--            method: 'POST',-->
<!--            body: formData-->
<!--        });-->
<!--        alert('Блюдо добавлено')-->
<!--    }-->

<!--    const addIngredient = document.querySelector('.addIngredient');-->

<!--    addIngredient.onclick = (event) => {-->
<!--        event.preventDefault();-->
<!--        const createIng = document.querySelector('.create-ing');-->
<!--        const select = document.querySelector('.create-ing__select');-->
<!--        const selectClone = select.cloneNode(true);-->
<!--        const selectCloneValue = select.options[select.selectedIndex].value;-->
<!--        const weigth = document.querySelector('.create-ing__weigth');-->

<!--        if (weigth.value == '') {-->
<!--            alert('Введите вес продукта')-->
<!--        } else if (selectClone.options[selectClone.selectedIndex].value == 0) {-->
<!--            alert('Выберите тип ингредиента')-->
<!--        } else {-->

<!--            // create block ingredient-->
<!--            let divIng = document.createElement('div');-->
<!--            divIng.className = 'ingredient';-->

<!--            // create select of ingedients-->
<!--            let selectIng = selectClone;-->
<!--            selectIng.className = 'ingredient__select-ing';-->
<!--            selectIng.name = 'id';-->
<!--            selectIng.value = selectCloneValue;-->

<!--            // create input for weigth-->
<!--            let inputWeigth = document.createElement('input');-->
<!--            inputWeigth.className = 'ingredient__input-weigth';-->
<!--            inputWeigth.name = 'weigth';-->
<!--            inputWeigth.value = weigth.value;-->

<!--            // calories-->


<!--            // create del btn-->
<!--            let btnDel = document.createElement('button');-->
<!--            btnDel.textContent = 'Удалить ингредиент';-->
<!--            btnDel.className = 'imgredient__del';-->
<!--            btnDel.onclick = () => {-->
<!--                btnDel.parentNode.remove();-->
<!--            }-->

<!--            divIng.appendChild(selectIng);-->
<!--            divIng.appendChild(inputWeigth);-->
<!--            divIng.appendChild(inputCalories);-->
<!--            divIng.appendChild(btnDel);-->
<!--            createIng.after(divIng);-->
<!--        }-->


<!--    }-->

<!--</script>-->

</body>

</html>